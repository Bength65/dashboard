<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <title>Crypto Dashboard</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <div class="logo">ðŸ’° MyWallet</div>
    <nav>
      <a href="#overview">Overview</a>
      <a href="#portfolio">Portfolio</a>
      <a href="#charts">Charts</a>
    </nav>
  </header>

  <main>
    <!-- Ã–versikt -->
    <section class="overview">
      <div class="balance-card">
        <h2>Total Balance</h2>
        <p>$154,610.00</p>
        <div class="performance">
          <span class="today">Today: -2.5%</span>
          <span class="week">Last 7 days: +4.2%</span>
        </div>
      </div>

      <div class="crypto-cards">
        <div class="crypto-card">Bitcoin <span>$52,291</span></div>
        <div class="crypto-card">Ethereum <span>$14,291</span></div>
        <div class="crypto-card">Solana <span>$14,291</span></div>
        <div class="crypto-card">Litecoin <span>$8,291</span></div>
      </div>
    </section>

    <!-- PortfÃ¶ljfÃ¶rdelning -->
    <section class="portfolio">
      <div>
        <h2>My Portfolio</h2>
        <ul>
          <li>Bitcoin â€“ 32%</li>
          <li>Tether â€“ 20%</li>
          <li>Ripple â€“ 18%</li>
          <li>Doge â€“ 15%</li>
          <li>Ethereum â€“ 15%</li>
        </ul>
      </div>
      <div class="panel">
        <h3>Portfolio split</h3>
        <div class="pie-chart"></div>
      </div>
    </section>

    <!-- Charts -->
    <section class="charts">
      <div class="panel">
        <h3>BTC/USDT Live Chart</h3>
        <div class="chart"></div>
        <div class="info-cards">
          <div class="card current">
            <h3>Aktuellt pris</h3>
            <p class="value">â€“</p>
          </div>
          <div class="card high">
            <h3>24h High</h3>
            <p class="value">â€“</p>
          </div>
          <div class="card low">
            <h3>24h Low</h3>
            <p class="value">â€“</p>
          </div>
        </div>
      </div>
      <div class="panel">
        <h3>Portfolio value over time</h3>
        <div class="line-chart"></div>
      </div>
    </section>
  </main>

  <!-- JS -->
  <script>
    // HÃ¤mtar live-data fÃ¶r BTC/USDT
    async function updateLabels() {
      const res = await fetch("https://api.binance.com/api/v3/ticker/24hr?symbol=BTCUSDT");
      const data = await res.json();

      const current = parseFloat(data.lastPrice).toFixed(2);
      const high24h = parseFloat(data.highPrice).toFixed(2);
      const low24h  = parseFloat(data.lowPrice).toFixed(2);

      document.querySelector('.card.current .value').textContent = `$${current}`;
      document.querySelector('.card.high .value').textContent    = `$${high24h}`;
      document.querySelector('.card.low .value').textContent     = `$${low24h}`;
    }

    // Uppdatera direkt och sedan var 10:e sekund
    updateLabels();
    setInterval(updateLabels, 10000);

    // Enkel demo fÃ¶r pie och line charts
    Plotly.newPlot(document.querySelector('.pie-chart'), [{
      values: [32, 20, 18, 15, 15],
      labels: ['Bitcoin','Tether','Ripple','Doge','Ethereum'],
      type: 'pie',
      textinfo: 'label+percent'
    }], { paper_bgcolor: 'transparent', font: { color: '#fff' } });

    Plotly.newPlot(document.querySelector('.line-chart'), [{
      x: ['2025-11-01','2025-11-02','2025-11-03','2025-11-04'],
      y: [35000, 36000, 37000, 38252],
      type: 'scatter',
      mode: 'lines+markers',
      line: { color: '#ffd700' }
    }], { paper_bgcolor: 'transparent', plot_bgcolor: '#1e1e2f', font: { color: '#fff' } });

    // Din candlestick chart
    async function fetchBTC(interval = "1m") {
      const res = await fetch(`https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=${interval}&limit=200`);
      const raw = await res.json();
      const x = raw.map(c => new Date(c[0]));
      const open = raw.map(c => +c[1]);
      const high = raw.map(c => +c[2]);
      const low  = raw.map(c => +c[3]);
      const close= raw.map(c => +c[4]);

      const candle = { x, open, high, low, close, type: 'candlestick', name: 'BTC/USDT' };
      return [candle];
    }

    async function renderBTC() {
      const data = await fetchBTC('1m');
      Plotly.newPlot(document.querySelector('.chart'), data, {
        paper_bgcolor: 'transparent',
        plot_bgcolor: '#1e1e2f',
        font: { color: '#fff' },
        xaxis: { showgrid: true, gridcolor: '#555' },
        yaxis: { showgrid: true, gridcolor: '#555', autorange: true }
      });
    }

    renderBTC();
    setInterval(async () => {
      const data = await fetchBTC('1m');
      Plotly.update(document.querySelector('.chart'), data);
    }, 10000);
  </script>
</body>
</html>